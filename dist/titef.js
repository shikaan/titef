!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(s){if(t[s])return t[s].exports;var E=t[s]={i:s,l:!1,exports:{}};return e[s].call(E.exports,E,E.exports,r),E.l=!0,E.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t){const r={PENDING:"PENDING",SUCCESS:"SUCCESS",FAILURE:"FAILURE",IGNORED:"IGNORED"},s=Object.values(r);e.exports={EVENT:{PROCESS:{EXIT:"process:exit",EXIT_CODE:{FAILURE:"process:exit-code:failure"}},DATABASE:{RECORDSET:{CREATE:"database:recordset:create",CLOSED:"database:recordset:closed"},RECORD:{CREATE:"database:record:create",UPDATE:"database:record:update",CLOSE:"database:record:close"},PROCESS:{ENDED:"database:process:ended"}},SUITE:{STARTED:"suite:started",HOOKS:{REGISTER:"suite:hooks:register",UNREGISTER:"suite:hooks:unregister"},ENDED:"suite:ended"},SPEC:{SETUP:{REGISTER:"spec:before-each:register",UNREGISTER:"spec:before-each:unregister"},TEARDOWN:{REGISTER:"spec:after-each:register",UNREGISTER:"spec:after-each:unregister"},STARTED:"spec:started",SUCCESS:"spec:success",IGNORE:"spec:ignore",FAILURE:"spec:failure",ENDED:"spec:ended"},REPORTER:{REPORT:{START:"reporter:report:start",ENDED:"reporter:report:ended"}}},RESULT:r,RESULTS:s}},function(e,t){e.exports=require("events")},function(e,t,r){const s=r(1),{EVENT:E}=r(0),n=new s,o={before:{},after:{}};n.on(E.SPEC.SETUP.REGISTER,(e,t)=>{o.before[e]=t}),n.on(E.SPEC.TEARDOWN.REGISTER,(e,t)=>{o.after[e]=t}),n.on(E.SPEC.SETUP.UNREGISTER,e=>{o.before[e]=null}),n.on(E.SPEC.TEARDOWN.UNREGISTER,e=>{o.after[e]=null}),e.exports={spec:async function(e,t){const r=String(e).replace("."," "),s=this.path,i=`${s}.${r}`;n.emit(E.SPEC.STARTED,i),o.before&&o.before[s]&&o.before[s]();try{await t(),n.emit(E.SPEC.SUCCESS,i)}catch(e){n.emit(E.SPEC.FAILURE,i,e)}o.after&&o.after[s]&&o.after[s](),n.emit(E.SPEC.ENDED,i)},xspec:async function(e){const t=String(e).replace("."," "),r=`${this.path}.${t}`;n.emit(E.SPEC.STARTED,r),n.emit(E.SPEC.IGNORE,r),n.emit(E.SPEC.ENDED,r)},Spec:n}},function(e,t,r){const s=r(1),{isFunction:E,isObject:n}=r(4),{EVENT:o}=r(0),i=new s;e.exports={suite:function(e,...t){const r=String(e).replace("."," "),s=this.path,c=s?`${s}.${r}`:r,a={title:r,setup:Function(),teardown:Function(),eachSetup:Function(),eachTeardown:Function(),silent:!1},{options:R,callback:S}=function(e,t){const r=e[0],s=e[1];switch(e.length){case 1:if(!E(r))throw new TypeError("Second argument must be a function!");return{options:t,callback:r};case 2:if(!n(r))throw new TypeError("Second argument must be an object!");if(!E(s))throw new TypeError("Third argument must be a function!");return{options:Object.assign({},t,r),callback:s};default:throw new TypeError(`Invalid arguments! Expected (title: string, options?: object, callback: function). Actual: ${e.map(String).join()}`)}}(t,a);if(i.emit(o.SUITE.STARTED,c,R.silent),i.emit(o.SUITE.HOOKS.REGISTER,c,R.eachSetup,R.eachTeardown),!E(R.setup))throw new TypeError("Setup must be a function!");R.setup(),S.call(Object.assign(this,{path:c})),Object.assign(this,{path:s}),i.on(o.SUITE.ENDED,e=>{if(e===c){if(!E(R.teardown))throw new TypeError("Teardown must be a function!");R.teardown(),i.emit(o.SUITE.HOOKS.UNREGISTER),i.removeAllListeners(o.SUITE.ENDED)}})},Suite:i}},function(e,t){e.exports={isNumber:e=>"[object Number]"===Object.prototype.toString.call(e),isFunction:e=>/\[object (Async)?Function]/.test(Object.prototype.toString.call(e)),isObject:e=>"[object Object]"===Object.prototype.toString.call(e)}},function(e,t,r){const{spec:s,xspec:E}=r(2),{suite:n}=r(3);r(6).init();const o={},i={suite:n.bind(o),describe:n.bind(o),spec:s.bind(o),it:s.bind(o),xspec:E.bind(o),xit:E.bind(o)};Object.assign(global,i),e.exports=i},function(e,t,r){const{EVENT:s,RESULT:E}=r(0),n=r(7),o=r(10),i=r(12),{Spec:c}=r(2),{Suite:a}=r(3);e.exports=new class{init(){this._reporters=[n],a.on(s.SUITE.STARTED,(e,t)=>{o.emit(s.DATABASE.RECORDSET.CREATE,e,t)}),a.on(s.SUITE.HOOKS.REGISTER,(e,t,r)=>{c.emit(s.SPEC.SETUP.REGISTER,e,t),c.emit(s.SPEC.TEARDOWN.REGISTER,e,r)}),a.on(s.SUITE.HOOKS.UNREGISTER,()=>{c.emit(s.SPEC.SETUP.UNREGISTER),c.emit(s.SPEC.TEARDOWN.UNREGISTER)}),c.on(s.SPEC.STARTED,e=>{o.emit(s.DATABASE.RECORD.CREATE,e)}),c.on(s.SPEC.SUCCESS,e=>{o.emit(s.DATABASE.RECORD.UPDATE,e,E.SUCCESS)}),c.on(s.SPEC.IGNORE,e=>{o.emit(s.DATABASE.RECORD.UPDATE,e,E.IGNORED)}),c.on(s.SPEC.FAILURE,(e,t)=>{o.emit(s.DATABASE.RECORD.UPDATE,e,E.FAILURE,t),i.emit(s.PROCESS.EXIT_CODE.FAILURE)}),c.on(s.SPEC.ENDED,e=>{o.emit(s.DATABASE.RECORD.CLOSE,e)}),o.on(s.DATABASE.PROCESS.ENDED,e=>{this._reporters.forEach(t=>{t.emit(s.REPORTER.REPORT.START,e)})}),o.on(s.DATABASE.RECORDSET.CLOSED,e=>{a.emit(s.SUITE.ENDED,e)}),this._reporters.forEach(e=>{e.on(s.REPORTER.REPORT.ENDED,()=>{i.emit(s.PROCESS.EXIT)})})}}},function(e,t,r){const s=r(1),{printDatabase:E}=r(8),{EVENT:n}=r(0);e.exports=new class extends s{constructor(){super(),this.on(n.REPORTER.REPORT.START,async e=>{await E(e),this.emit(n.REPORTER.REPORT.ENDED)})}}},function(e,t,r){const{isFunction:s}=r(4),{TEXT_FORMAT:E}=r(9),{RESULT:n}=r(0),o=(...e)=>{const t=[...e,E.RESET,"\n"];return process.stdout.write(t.map(String).join(""))},i=e=>s(e)?e.name:String(e),c=(e,t,r="")=>{const s={};return e.meta.silent||o(E.BOLD,`${r}${t.toUpperCase()}`),Object.entries(e).forEach(([i,a])=>{if(!(a.meta&&a.meta.silent||e.meta.silent)){a.meta?Object.assign(s,c(a,i,`${r}    `)):a.result===n.SUCCESS?o(E.GREEN,`${r} âœ” ${i}`):a.result===n.IGNORED?o(E.YELLOW,`${r} - ${i}`):a.result===n.PENDING?o(E.GREY,`${r} . ${i}`):(o(E.RED,`${r} âœ• ${i}`),s[`${t} > ${i}`]=a.payload)}}),s};e.exports={printDatabase:async e=>{let t={};Object.entries(e).forEach(([e,r])=>{t=c(r,e),o("\n  Suite duration: ",E.YELLOW,`${r.meta.duration}s`)});const r=Object.entries(t);r.length&&(o(E.BOLD,"\nError details:"),r.forEach((e,t)=>{const r=e[0],s=e[1];o(E.BOLD,`\n${t+1}) ${r}`),(e=>{const t=(e=>e.message?e.message:e.toString().split(":").slice(-1)[0])(e);if((e=>"ERR_ASSERTION"===e.code||0===e.toString().indexOf("AssertionError"))(e)){const r=i(e.operator),s=i(e.expected),n=i(e.actual);o(`ASSERTION FAILURE: ${t}`),"fail"===r?o("\tUnexpected:\t",E.RED,`${n}`):!r&&e.expected&&e.actual&&(o("\tExpected:\t",E.GREEN,s),o("\tActual:\t\t",E.RED,n))}else o(`ERROR: ${t}`);o(E.GREY,e.stack)})(s)}))}}},function(e,t){e.exports={TEXT_FORMAT:{RED:"[31m",GREEN:"[32m",YELLOW:"[33m",RESET:"[0m",BOLD:"[1m",GREY:"[90m"}}},function(e,t,r){const s=r(1),{PerformanceObserver:E,performance:n}=r(11),{EVENT:o,RESULT:i,RESULTS:c}=r(0);class a extends s{static create(e,t,r){const[s,E]=t.split(/\.(.*)/);return E?(e[s]=e[s]||{},a.create(e[s],E,r)):(e[s]=r,e)}static open(e,t){const[r,s]=t.split(/\.(.*)/);return s?a.open(e[r],s):e[r]}static parent(e,t){const[r,s]=t.split(/\.(.*)/);return s?a.parent(e[r],s):e}constructor(){super(),this._recordsets={},this._processed=0,this._created=0,this.on(o.DATABASE.RECORDSET.CREATE,this.createRecordset),this.on(o.DATABASE.RECORD.CREATE,this.createRecord),this.on(o.DATABASE.RECORD.UPDATE,this.updateRecord),this.on(o.DATABASE.RECORD.CLOSE,this.closeRecord)}createRecordset(e,t){const r={duration:null,processed:0,path:e,silent:t};a.create(this._recordsets,e,Object.defineProperty({},"meta",{value:r})),new E(e=>{r.duration=Math.ceil(e.getEntries()[0].duration)/1e3,n.clearMarks(),this.emit(o.DATABASE.PROCESS.ENDED,this._recordsets)}).observe({entryTypes:["measure"]}),n.mark(`${e}:init`)}createRecord(e){if(!e)throw new TypeError("Missing record path!");if(!a.parent(this._recordsets,e))throw new TypeError(`Missing or null records list for ${e}`);this._created+=1,a.create(this._recordsets,e,{result:i.PENDING,payload:null})}updateRecord(e,t,r){if(!c.includes(t))throw new TypeError(`Result should be one of ${c.join()}. Got ${t}.`);const s=a.open(this._recordsets,e);if(!s)throw new TypeError(`Missing or null records list for ${e}`);s.result=t,s.payload=r}closeRecord(e){setImmediate(()=>{this._processed+=1;const t=this._processed===this._created,r=a.parent(this._recordsets,e);r.meta.processed+=1;const s=Object.values(r).filter(e=>!e.meta).length,E=r.meta.processed===s;t?(n.mark(`${e}:end`),n.measure("Duration",`${e}:init`,`${e}:end`)):E&&this.emit(o.DATABASE.RECORDSET.CLOSED,r.meta.path)})}}e.exports=new a},function(e,t){e.exports=require("perf_hooks")},function(e,t,r){const s=r(1),{EVENT:E}=r(0);e.exports=new class extends s{constructor(){super(),this._exitCode=0,this.on(E.PROCESS.EXIT,()=>{process.exit(this._exitCode)}),this.on(E.PROCESS.EXIT_CODE.FAILURE,()=>{this._exitCode=1})}}}]));